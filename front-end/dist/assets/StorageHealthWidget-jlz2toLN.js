import{p as f,u as g,r as N,j as e,C as m,a as x,b as d,H as c,e as h,T as v,P as w,f as u,A as _}from"./index-CiW3by5p.js";function b(s){return s<40?"text-green-500":s<55?"text-yellow-500":s<70?"text-orange-500":"text-red-500"}const y=({disk:s,nvme:r})=>{const a=s.percent>90?"danger":s.percent>75?"warning":"default",i=r?b(r.temp_composite):"";return e.jsxs("div",{className:"p-3 rounded-lg bg-secondary/30 hover:bg-secondary/50 transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"font-medium text-sm",children:s.mount})]}),r&&e.jsxs("div",{className:`flex items-center gap-1 ${i}`,children:[e.jsx(v,{className:"w-3 h-3"}),e.jsxs("span",{className:"text-xs font-mono",children:[r.temp_composite.toFixed(0),"°C"]})]})]}),e.jsx(w,{value:s.percent,variant:a,label:`${s.percent.toFixed(1)}%`}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{title:"Read",children:["R: ",u(s.read_bps),"/s"]}),e.jsxs("span",{title:"Write",children:["W: ",u(s.write_bps),"/s"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),e.jsxs("span",{children:[s.read_iops.toFixed(0),"+",s.write_iops.toFixed(0)," IOPS"]})]})]}),s.io_wait_pct>5&&e.jsxs("div",{className:"mt-1 text-xs text-orange-500",children:["⚠ IO Wait: ",s.io_wait_pct.toFixed(1),"%"]})]})},C=f.memo(()=>{const s=g(t=>t.liveData),r=s?.full_sensors,a=s?.disks,i=N.useMemo(()=>{const t=new Map;if(!r?.nvme_sensors)return t;const n=a?.filter(l=>l.mount.includes("nvme")||l.mount==="/"||l.mount.includes("ssd"))||[];return r.nvme_sensors.forEach((l,o)=>{o<n.length&&t.set(n[o].mount,l)}),t},[r?.nvme_sensors,a]);if(!a||a.length===0)return e.jsxs(m,{className:"h-full",children:[e.jsx(x,{className:"pb-2",children:e.jsxs(d,{className:"flex items-center gap-2 text-sm",children:[e.jsx(c,{className:"w-4 h-4 text-blue-500"}),"Storage Health"]})}),e.jsx(h,{children:e.jsx("div",{className:"text-muted-foreground text-sm",children:"No storage devices detected"})})]});const p=a.reduce((t,n)=>t+n.read_iops+n.write_iops,0),j=a.length>0?a.reduce((t,n)=>t+n.avg_wait_ms,0)/a.length:0;return e.jsxs(m,{className:"h-full",children:[e.jsx(x,{className:"pb-2",children:e.jsxs(d,{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{className:"w-4 h-4 text-blue-500"}),"Storage Health"]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground font-normal",children:[e.jsxs("span",{children:[p.toFixed(0)," IOPS"]}),e.jsxs("span",{children:[j.toFixed(1),"ms wait"]})]})]})}),e.jsx(h,{children:e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:a.map(t=>e.jsx(y,{disk:t,nvme:i.get(t.mount)},t.mount))})})]})});C.displayName="StorageHealthWidget";export{C as StorageHealthWidget};
